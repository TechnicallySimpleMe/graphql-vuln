---
kind: pipeline
type: exec
name: default

platform:
  os: linux
  arch: amd64

steps:
- name: greeting
  commands:
  - echo hello world
  - echo hello world 2
- name: test docker
  environment:
    PASSWORD:
      from_secret: AQUA_DEMO_PASS
    USERNAME:
      from_secret: AQUA_DEMO_USER
    DH_PASSWORD:
      from_secret: DH_DEMO_PASS
    DH_USERNAME:
      from_secret: DH_DEMO_USER
    AQUA_TOKEN:
      from_secret: AQUA_TOKEN
    AQUA_SERVER:
      from_secret: AQUA_SERVER
      
  commands:
  - docker login -u $DH_USERNAME -p $DH_PASSWORD
  - docker images
  - docker pull zookeeper:latest
  - docker pull hello-world
  - docker run -d -e SCALOCK_LOG_LEVEL=DEBUG  registry.aquasec.com/scanner-cli:2210.13.7 daemon --token $AQUA_TOKEN --host $AQUA_SERVER --local zookeeper:latest
